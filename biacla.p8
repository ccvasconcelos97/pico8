pico-8 cartridge // http://www.pico-8.com
version 42
__lua__



-- sprite positions
x1 = 0
x2 = 120

-- state variables
shake_phase = 0   -- 0 = moving, 1 = delay before shake1, 2 = shake1, 3 = delay before shake2, 4 = shake2, 5 = done
delay_timer = 0
shake_timer = 0



function _update()
  if shake_phase == 0 then
    -- move sprites toward each other
    if x1 < 60 then
      x1 += 1
    end
    if x2 > 68 then
      x2 -= 1
    end

    -- if they meet, start delay before first shake
    if x1 == 60 and x2 == 68 then
      shake_phase = 1
      delay_timer = 30 -- longer delay
    end

  elseif shake_phase == 1 then
    -- delay before sprite 1 shakes
    delay_timer -= 1
    if delay_timer <= 0 then
      shake_phase = 2
      shake_timer = 15
      sfx(0) -- sound effect 0
    end

  elseif shake_phase == 2 then
    -- sprite 1 shaking
    shake_timer -= 1
    if shake_timer <= 0 then
      shake_phase = 3
      delay_timer = 30 -- longer delay before sprite 2 shakes
    end

  elseif shake_phase == 3 then
    -- delay before sprite 2 shakes
    delay_timer -= 1
    if delay_timer <= 0 then
      shake_phase = 4
      shake_timer = 15
      sfx(1) -- sound effect 1
    end

  elseif shake_phase == 4 then
    -- sprite 2 shaking
    shake_timer -= 1
    if shake_timer <= 0 then
      shake_phase = 5 -- done
    end
  end
end

function _draw()
  cls()

  -- shake offsets
  local offset1 = 0
  local offset2 = 0

  if shake_phase == 2 then
    offset1 = rnd(3) - 1
  end

  if shake_phase == 4 then
    offset2 = rnd(3) - 1
  end

  spr(1, x1 + offset1, 60)              -- sprite ID 1
  spr(2, x2 + offset2, 60, 1, 1, true)  -- sprite ID 2 flipped
end

__gfx__
00000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000006000000f4fff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000666666660f4f07f400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000607660764fff00ff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070066666666f4ffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000005565565548f4f8f400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006006000800080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0005000000000000002b550000002b55000000305500f05000000000002205000000000002d150000002a15026150211501b1501a15000000000000000000000000002a050000002f05000000310500000000000
00050000240501e0501b050180501503016050160501705018050190501a0501a05018050160501505013050100500e0500d0500b0500a0500905009050090500a0500b050000500005000050000500005000050
